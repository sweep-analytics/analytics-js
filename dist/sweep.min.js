/*!
 * @sweep/analytics-js v0.0.4
 * Copyright (c) 2019-2019 Sweep Analytics
 * License: MIT
 */
!function(e){"function"==typeof define&&define.amd?define(e):e()}(function(){"use strict";function e(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function n(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}for(var t=function(e,n){return e(n={exports:{}},n.exports),n.exports}(function(e){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var t=new Uint8Array(16);e.exports=function(){return n(t),t}}else{var r=new Array(16);e.exports=function(){for(var e,n=0;n<16;n++)0==(3&n)&&(e=4294967296*Math.random()),r[n]=e>>>((3&n)<<3)&255;return r}}}),r=[],o=0;o<256;++o)r[o]=(o+256).toString(16).substr(1);var a=function(e,n){var t=n||0,o=r;return[o[e[t++]],o[e[t++]],o[e[t++]],o[e[t++]],"-",o[e[t++]],o[e[t++]],"-",o[e[t++]],o[e[t++]],"-",o[e[t++]],o[e[t++]],"-",o[e[t++]],o[e[t++]],o[e[t++]],o[e[t++]],o[e[t++]],o[e[t++]]].join("")};var i=function(e,n,r){var o=n&&r||0;"string"==typeof e&&(n="binary"===e?new Array(16):null,e=null);var i=(e=e||{}).random||(e.rng||t)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,n)for(var c=0;c<16;++c)n[o+c]=i[c];return n||a(i)};function c(e,n){var t=new Date;t.setTime(t.getTime()+31536e6);var r="; expires="+t.toUTCString();document.cookie=e+"="+(n||"")+r+"; path=/"}function s(e){for(var n=e+"=",t=document.cookie.split(";"),r=0;r<t.length;r++){for(var o=t[r];" "===o.charAt(0);)o=o.substring(1,o.length);if(0===o.indexOf(n))return o.substring(n.length,o.length)}return null}var u=function e(n){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this.clientId=n,window.sweep={sweepApiKey:n}},l=function(){return"mutation trackEvent($name: String!, $client: String!, $meta: JSON) {\n  trackEvent(input: { name: $name, client: $client, meta: $meta }) { \n    name,\n    client,\n    meta\n  }\n}"};var p,d={key:(p=document.currentScript).getAttribute("key"),logs:p.getAttribute("logs")};document.addEventListener("DOMContentLoaded",function(){new u(d.key);w(),[].slice.call(document.querySelectorAll("[data-sweep-click]")).forEach(function(t){t.addEventListener("click",function(t){var r=t.target.getAttribute("data-sweep-click");f("click",function(t){for(var r=1;r<arguments.length;r++){var o=null!=arguments[r]?arguments[r]:{};r%2?n(o,!0).forEach(function(n){e(t,n,o[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):n(o).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))})}return t}({},r.split(",")))})}),"true"===d.logs&&g()});var f=function(e,n){!function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};s("s_a_js_uid")||c("s_a_js_uid",i());try{var t=window.sweep.sweepApiKey;if(!t)throw new Error("No api key provided");var r=window.navigator,o=window.location;if(r.userAgent.search(/(bot|spider|crawl)/gi)>-1)throw new Error("bot… not tracked");n.path=o.pathname;var a={method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({operationName:"trackEvent",query:l(),variables:{name:e,client:t,meta:n}})};fetch("https://api.sweep-analytics.com/public",a).then(function(){console.log("send event")}).catch(function(e){throw new Error(e)})}catch(e){console.error(e)}}(e,n)},w=function(){!function(){s("s_a_js_uid")||c("s_a_js_uid",i());try{var e=window.sweep.sweepApiKey;if(!e)throw new Error("No api key provided");var n=window.navigator,t=window.location,r=n.userAgent;if(r.search(/(bot|spider|crawl)/gi)>-1)throw new Error("bot… not tracked");var o,a="";o=t.hash?t.protocol+"//"+t.hostname+t.pathname+t.hash:t.protocol+"//"+t.hostname+t.pathname;var u=document.referrer,p=navigator.language,d=navigator.platform,f="".concat(window.screen.width,"x").concat(window.screen.height),w={url:o,referrer:u,anonymousId:s("s_a_js_uid"),language:p,platform:d,userAgent:r,screen:f},g={method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({operationName:"trackEvent",query:l(),variables:{name:"userSession",client:e,meta:w}})};if(a===o)return;a=o,fetch("https://api.sweep-analytics.com/public",g).then(function(){console.log("send")}).catch(function(e){throw new Error(e)})}catch(e){console.error(e)}}()},g=function(){!function(){s("s_a_js_uid")||c("s_a_js_uid",i());try{if(!window.sweep.sweepApiKey)throw new Error("No api key provided");var e,n=window.navigator,t=window.location,r=n.userAgent;if(r.search(/(bot|spider|crawl)/gi)>-1)throw new Error("bot… not tracked");e=t.hash?t.protocol+"//"+t.hostname+t.pathname+t.hash:t.protocol+"//"+t.hostname+t.pathname;var o=document.referrer,a=navigator.language,u=navigator.platform,l="".concat(window.screen.width,"x").concat(window.screen.height),p={url:e,referrer:o,anonymousId:s("s_a_js_uid"),language:a,platform:u,userAgent:r,screen:l};window.addEventListener("error",function(e){var n={line:e.lineno,filename:e.filename,message:e.message,error:e.error};console.log("error data"),console.log(p),console.log(n)})}catch(e){console.error(e)}}()}});
