/*!
 * sweep-analytics-js v0.0.2
 * Copyright (c) 2019-2019 Fabian Bentz & Jonas Regner
 * License: MIT
 */
!function(e){"function"==typeof define&&define.amd?define(e):e()}(function(){"use strict";function e(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function n(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}for(var t=function(e,n){return e(n={exports:{}},n.exports),n.exports}(function(e){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var t=new Uint8Array(16);e.exports=function(){return n(t),t}}else{var r=new Array(16);e.exports=function(){for(var e,n=0;n<16;n++)0==(3&n)&&(e=4294967296*Math.random()),r[n]=e>>>((3&n)<<3)&255;return r}}}),r=[],o=0;o<256;++o)r[o]=(o+256).toString(16).substr(1);var i=function(e,n){var t=n||0,o=r;return[o[e[t++]],o[e[t++]],o[e[t++]],o[e[t++]],"-",o[e[t++]],o[e[t++]],"-",o[e[t++]],o[e[t++]],"-",o[e[t++]],o[e[t++]],"-",o[e[t++]],o[e[t++]],o[e[t++]],o[e[t++]],o[e[t++]],o[e[t++]]].join("")};var a=function(e,n,r){var o=n&&r||0;"string"==typeof e&&(n="binary"===e?new Array(16):null,e=null);var a=(e=e||{}).random||(e.rng||t)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,n)for(var c=0;c<16;++c)n[o+c]=a[c];return n||i(a)};function c(e,n){var t=new Date;t.setTime(t.getTime()+31536e6);var r="; expires="+t.toUTCString();document.cookie=e+"="+(n||"")+r+"; path=/"}function s(e){for(var n=e+"=",t=document.cookie.split(";"),r=0;r<t.length;r++){for(var o=t[r];" "===o.charAt(0);)o=o.substring(1,o.length);if(0===o.indexOf(n))return o.substring(n.length,o.length)}return null}var u=function e(n){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this.clientId=n,window.sweep={sweepApiKey:n}},l=function(){return"mutation trackEvent($name: String!, $client: String!, $meta: JSON) {\n  trackEvent(input: { name: $name, client: $client, meta: $meta }) { \n    name,\n    client,\n    meta\n  }\n}"};var p,f={key:(p=document.currentScript).getAttribute("key"),logs:p.getAttribute("logs")};document.addEventListener("DOMContentLoaded",function(){new u(f.key);m(),[].slice.call(document.querySelectorAll("[data-sweep-click]")).forEach(function(t){t.addEventListener("click",function(t){var r=t.target.getAttribute("data-sweep-click");d("click",function(t){for(var r=1;r<arguments.length;r++){var o=null!=arguments[r]?arguments[r]:{};r%2?n(o,!0).forEach(function(n){e(t,n,o[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):n(o).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))})}return t}({},r.split(",")))})}),"true"===f.logs&&g()});var d=function(e,n){!function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};s("s_a_js_uid")||c("s_a_js_uid",a());var t=window.sweep.sweepApiKey;if(!t)throw new Error("No api key provided");n.path=document.location.pathname;var r={method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({operationName:"trackEvent",query:l(),variables:{name:e,client:t,meta:n}})};fetch("https://api.sweep-analytics.com/public",r).then(function(e){}).catch(function(e){console.log(e)})}(e,n)},m=function(){!function(){s("s_a_js_uid")||c("s_a_js_uid",a());var e=window.sweep.sweepApiKey;if(!e)throw new Error("No api key provided");var n=document.location.pathname,t=document.referrer,r=navigator.language,o=navigator.platform,i="".concat(window.screen.width,"x").concat(window.screen.height),u={url:n,referrer:t,anonymousId:s("s_a_js_uid"),language:r,platform:o,screen:i},p={method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({operationName:"trackEvent",query:l(),variables:{name:"userSession",client:e,meta:u}})};fetch("https://api.sweep-analytics.com/public",p).then(function(e){}).catch(function(e){console.log(e)})}()},g=function(){!function(){if(s("s_a_js_uid")||c("s_a_js_uid",a()),!window.sweep.sweepApiKey)throw new Error("No api key provided");var e=document.location.pathname,n=document.referrer,t=navigator.language,r=navigator.platform,o="".concat(window.screen.width,"x").concat(window.screen.height),i={url:e,referrer:n,anonymousId:s("s_a_js_uid"),language:t,platform:r,screen:o};window.addEventListener("error",function(e){var n={line:e.lineno,filename:e.filename,message:e.message,error:e.error};console.log("error data"),console.log(i),console.log(n)})}()}});
